import"./modulepreload-polyfill-YP0FEG5d.js";import{a as t,f as e}from"./app-shell-CtSII-jN.js";import{s,a as r,b as a}from"./shared-utils-DEXrBstL.js";import{serverTimestamp as o,collection as i,addDoc as u}from"https://www.gstatic.com/firebasejs/12.6.0/firebase-firestore.js";import"https://www.gstatic.com/firebasejs/12.6.0/firebase-app.js";import"https://www.gstatic.com/firebasejs/12.6.0/firebase-auth.js";import"https://www.gstatic.com/firebasejs/12.6.0/firebase-storage.js";const n={supportForm:document.getElementById("support-form"),nameInput:document.getElementById("support-name"),emailInput:document.getElementById("support-email"),subjectInput:document.getElementById("support-subject"),messageInput:document.getElementById("support-message"),submitBtn:document.getElementById("submit-ticket-btn")};let m=!1;!function(e){const s=()=>{t.currentUser?(console.log("Support Logic: Auth is ready."),e(t.currentUser)):(console.log("Support logic waiting for authentication..."),requestAnimationFrame(s))};requestAnimationFrame(s)}(t=>{var p;!async function(t){t.email&&(n.emailInput.value=t.email,n.emailInput.disabled=!0);const e=t.displayName||"";e&&(n.nameInput.value=e)}(t),p=t.uid,n.supportForm.addEventListener("submit",t=>async function(t,p){if(t.preventDefault(),m)return;const l=s(n.nameInput.value.trim()),c=s(n.subjectInput.value.trim()),d=s(n.messageInput.value.trim());if(!l||!c||!d)return void r("Validation Error","Please fill out all required fields.","error");m=!0,a(n.submitBtn,!0);const f={userId:p,fullName:l,email:n.emailInput.value,subject:c,message:d,status:"new",createdAt:o()};try{const t=i(e,"support_tickets");await u(t,f),r("Success","Your support ticket has been submitted. We will respond soon.","success"),n.subjectInput.value="",n.messageInput.value=""}catch(b){console.error("Error submitting support ticket:",b),r("Error","Could not submit ticket. Please try again later.","error")}finally{m=!1,a(n.submitBtn,!1)}}(t,p))});
